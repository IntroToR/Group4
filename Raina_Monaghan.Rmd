---
title: "Raina"
author: "Raina Monaghan"
date: "10/11/2020"
output: html_document
---


<!-- Will add comments later -->
```{r}
library(dplyr)
library(tidyverse)
library(tidytuesdayR)
library(ggplot2)

dairy = tt_load(2019, 5)

clean_cheese <- dairy$clean_cheese
clean_cheese <- clean_cheese %>% rename(year = Year)
milk_product_facts <- dairy$milk_products_facts

joined <-
  inner_join(clean_cheese, dairy$milk_products_facts, by = "year")
joined <-
  select(joined,
         "Cheddar":"Foods and spreads",
         "cheese_american":"cheese_cottage")
joined <- na.omit(clean_cheese)
clean_cheese <- na.omit(clean_cheese)
view(joined)
summary(joined)

clean_cheese_long <- clean_cheese %>%
  gather(cheese_type, lbs_per_person,-year) 
summary(clean_cheese_long)


tac <- clean_cheese$`Total American Chese`
tic <- clean_cheese$`Total Italian Cheese`
tnc <- clean_cheese$`Total Natural Cheese`
tpcp <- clean_cheese$`Total Processed Cheese Products`
year<- clean_cheese$year


ggplot(clean_cheese) + geom_line(
  aes(
    x = year,
    y = tnc,
    color = "Total Natural Cheese"
  )
) +
  geom_line(
    aes(
      x = year,
      tpcp,
      color = "Total Processed Cheese"
    )
  ) + labs(
    title = "Total Natural Cheese and Total Processed Cheese Consumption",
    subtitle = "A comparison of lbs per person consumed (1970 to 2017)",
    y = "lbs per person",
    x = "Year"
  )


ggplot(clean_cheese) + geom_line(
  aes(
    x = year,
    y = tic,
    color = "Total Italian Cheese"
  )
) +
  geom_line(
    aes(
      x = year,
      y = tac,
      color = "Total American Cheese"
    )
  ) + labs(
    title = "Total Italian Cheese and Total American Cheese Consumption",
    subtitle = "A comparison of lbs per person consumed (1970 to 2017)",
    y = "lbs per person",
    x = "Year"
  )

ggplot(
  clean_cheese,
  aes(
    x = year,
    y = tpcp,
    color = "Total Processed Cheese"
  )
) + geom_point() +
  geom_smooth(method = lm,
              se = TRUE,
              fullrange = TRUE)



tpcp.reg <-
  lm(year ~ tpcp)
summary(tpcp.reg)

tnc.reg <-
  lm(year ~ tnc)
summary(tnc.reg)

tac.reg <- lm(year ~ tac)
summary(tac.reg)

tic.reg <- lm(year ~ tic)
summary(tic)

```